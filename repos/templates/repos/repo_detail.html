{% extends "base.html" %}

{% load common django_bootstrap5 icons %}

{% block page_title %}Repository - {{ repo }} {% endblock %}

{% block breadcrumbs %} {{ block.super }} <li class="breadcrumb-item"><a href="{% url 'repos:repo_list' %}">Repositories</a></li><li class="breadcrumb-item active">{{ repo }}</li>{% endblock %}

{% block content_title %}Repository - {{ repo }} {% endblock %}

{% block content %}

<ul class="nav nav-tabs">
  <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#repo_details">Details</a></li>
  <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#repo_mirrors">Mirrors</a></li>
  <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#repo_hosts">Hosts with this Repository</a></li>
  <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#repo_osgroups">OS Groups with this Repository</a></li>
  <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#repo_modules">Modules in this Repository</a></li>
</ul>

<div class="tab-content">
  <div class="tab-pane fade show active" id="repo_details">
    <div class="card">
      <table class="table table-striped table-bordered table-hover table-sm table-responsive">
        <tr><th>Name</th><td> {{ repo.name }} </td></tr>
        <tr><th>ID</th><td> {% if repo.id != None %} {{ repo.id }} {% endif %}</td></tr>
        <tr><th>Type</th><td> {{ repo.get_repotype_display }} </td></tr>
        <tr><th>Architecture</th><td> {{ repo.arch }} </td></tr>
        <tr><th>Security</th><td> {% yes_no_img repo.security 'Security' 'Not Security' %} </td></tr>
        <tr><th>Enabled</th><td> {% yes_no_img repo.enabled 'Enabled' 'Not Enabled' %} </td></tr>
        <tr><th>Mirrors</th><td> {{ repo.mirror_set.count }} </td></tr>
        <tr><th>Requires Authentication</th><td> {{ repo.auth_required }} </td></tr>
      </table>
    </div>
    <div>
      {% if user.is_authenticated and perms.is_admin %}
        <a class="btn btn-outline-primary btn-sm" role="button" href="{% url 'repos:repo_delete' repo.id %}">{% icon "trash" %} Delete this Repository</a>
        <a class="btn btn-outline-primary btn-sm" role="button" href="{% url 'repos:repo_edit' repo.id %}">{% icon "edit" %} Edit this Repository</a>
        {% if repo.enabled %}
          <a class="btn btn-outline-primary btn-sm" role="button" href="{% url 'repos:repo_toggle_enabled' repo.id %}">{% icon "remove-sign" %} Disable this Repository</a>
        {% else %}
          <a class="btn btn-outline-primary btn-sm" role="button" href="{% url 'repos:repo_toggle_enabled' repo.id %}">{% icon "ok-sign" %} Enable this Repository</a>
        {% endif %}
        {% if repo.security %}
          <a class="btn btn-outline-primary btn-sm" role="button" href="{% url 'repos:repo_toggle_security' repo.id %}">{% icon "star-empty" %} Mark as Non-Security repo</a>
        {% else %}
          <a class="btn btn-outline-primary btn-sm" role="button" href="{% url 'repos:repo_toggle_security' repo.id %}">{% icon "star" %} Mark as Security repo</a>
        {% endif %}
      {% endif %}
    </div>
  </div>

  <div class="tab-pane fade in" id="repo_mirrors">
    <div class="card">
      {% gen_table repo.mirror_set.all %}
    </div>
  </div>

  <div class="tab-pane fade in" id="repo_hosts">
    <div class="card">
      {% gen_table repo.host_set.all.distinct %}
    </div>
  </div>

  <div class="tab-pane fade in" id="repo_osgroups">
    <div class="card">
      {% gen_table repo.osgroup_set.all.distinct %}
    </div>
  </div>

  <div class="tab-pane fade in" id="repo_modules">
    <div class="card">
        <div class="card">
          {% gen_table repo.module_set.all %}
        </div>
    </div>
  </div>
</div>

{% endblock %}
