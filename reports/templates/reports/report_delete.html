{% extends "base.html" %}

{% load django_bootstrap5 icons %}

{% block page_title %}Report - {{ report }} {% endblock %}

{% block breadcrumbs %} {{ block.super }} <li class="breadcrumb-item"><a href="{% url 'reports:report_list' %}">Reports</a></li><li class="breadcrumb-item active">{{ report }}</li>{% endblock %}

{% block content_title %} Report - {{ report }} {% endblock %}

{% block content %}

<div class="card">
  <table class="table table-striped table-bordered table-hover table-sm table-responsive">
    <tr><th>Host</th><td> {{ report.host }} </td></tr>
    <tr><th>Reporting IP Address</th><td> {{ report.report_ip }} </td></tr>
    <tr><th>Domain</th><td> {{ report.domain }} </td></tr>
    <tr><th>Running Kernel</th><td> {{ report.kernel }} </td></tr>
    <tr><th>Reboot Required?</th><td> {{ report.reboot }} </td></tr>
    <tr><th>OS</th><td> {{ report.os }} </td></tr>
    <tr><th>Arch</th><td> {{ report.arch }} </td></tr>
    <tr><th>Tags</th><td> {{ report.tags }} </td></tr>
    <tr><th>Client Protocol</th><td> {{ report.protocol }} </td></tr>
    <tr><th>User Agent</th><td> {{ report.useragent }} </td></tr>
    <tr><th>Has Been Processed?</th><td> {{ report.processed }} </td></tr>
  </table>

  <div class="card bg-danger">
    {% if user.is_authenticated and perms.is_admin %}
      <div class="card-header">
        Are you sure you want to delete this Report?
      </div>
      <div class="card-body">
        <form action={{ request.path }} method="post">
          {% csrf_token %}
          <button name="delete" type="submit" class="btn btn-outline-primary btn-sm">{% icon "trash" %} Delete</button>
          <button name="cancel" type="submit" class="btn btn-outline-primary btn-sm">{% icon "stop" %} Cancel</button>
        </form>
      </div>
    {% else %}
      <div class="card-header">
        You do not have permission to delete this Report.
      </div>
        <div class="card-body">
        <a class="btn btn-outline-primary btn-sm" href="{{ report.get_absolute_url }}">{% icon "arrow-left" %} Back</a>
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
